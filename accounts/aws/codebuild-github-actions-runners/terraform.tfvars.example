# Copy this file to terraform.tfvars and customize the values

# GitHub and webhook configuration
# Controls both the CodeBuild source location and webhook scope
#
# For repository-level webhooks (single repository):
github_config = {
  webhook_scope = "REPOSITORY"
  location      = "https://github.com/your-github-username-or-org/your-repo"
}

# For organization-level webhooks (all repos in an organization):
# github_config = {
#   webhook_scope           = "GITHUB_ORGANIZATION"
#   github_organization_name = "your-organization-name"
#   # location is automatically set to CODEBUILD_DEFAULT_WEBHOOK_SOURCE_LOCATION
# }

# CodeConnections connection ARN for GitHub (using GitHub App)
# When provided, CodeConnections will be used instead of webhooks and PAT authentication.
# Example format (replace with your actual ARN):
# codeconnections_connection_arn = "arn:aws:codeconnections:REGION:ACCOUNT_ID:connection/CONNECTION_ID"

# Build timeout in minutes (optional, defaults to 60)
build_timeout = 60

# CodeBuild Runners Configuration
# Supports:
# - ON_DEMAND: Standard CodeBuild compute types
# - FLEET: Compute Fleets with reserved capacity
#
# This example shows two ON_DEMAND runners (x86_64 and arm64) with:
# - 2 vCPUs
# - 4 GB memory
# - 64 GB disk
# - VPC configuration included
#
# NOTES:
# - Replace vpc_id and subnet_ids with your own network values.
# - For FLEET runners, set compute_type = "FLEET" and adjust fields as needed.
# - Ensure images and compute types are valid in your chosen region.

runners = [
  {
    name       = "gha-x86-small"

    compute_type           = "ON_DEMAND"
    architecture           = "x86_64"
    on_demand_compute_type = "BUILD_GENERAL1_SMALL"
    image                  = "aws/codebuild/amazonlinux-x86_64-standard:5.0"

    # For Compute Fleets (if used):
    # minimum_capacity = 1
    # compute_configuration = {
    #   vcpu_count = 2
    #   memory     = 4
    #   disk_space = 64
    # }

    # For VPC configuration:
    vpc_config = {
      vpc_id = "vpc-xxxxxxxx"
      subnet_ids = [
        "subnet-xxxxxxxx"
      ]
    }

    # Example: if using fleets with reserved capacity, uncomment and adjust:
    # compute_configuration = {
    #   vcpu_count = 2
    #   memory     = 4
    #   disk_space = 64
    # }
  },
  {
    name       = "gha-arm64-small"

    compute_type           = "ON_DEMAND"
    architecture           = "arm64"
    on_demand_compute_type = "BUILD_GENERAL1_SMALL"
    image                  = "aws/codebuild/amazonlinux-aarch64-standard:3.0"

    # For VPC configuration:
    vpc_config = {
      vpc_id = "vpc-xxxxxxxx"
      subnet_ids = [
        "subnet-yyyyyyyy"
      ]
    }

    # Example: if using fleets:
    # minimum_capacity = 1
    # compute_configuration = {
    #   vcpu_count = 2
    #   memory     = 4
    #   disk_space = 64
    # }
  }
]
